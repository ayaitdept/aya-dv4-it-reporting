<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AYA DV-4 IT Reporting System</title>
<style>
body{font-family:Arial;background:#f4f6f8}
.container{max-width:900px;margin:30px auto;background:#fff;padding:25px;border-radius:10px}
label{font-weight:bold;display:block;margin-top:10px}
input,textarea,button{width:100%;padding:10px;margin-top:5px}
button{background:#007bff;color:#fff;border:none;margin-top:20px}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ccc;padding:8px}
th{background:#007bff;color:white}
</style>
</head>

<body>
<div class="container">
<h2>AYA DV-4 IT Reporting System</h2>

<form id="reportForm">
<label>Branch Name</label><input required>
<label>Date</label><input type="date" required>
<label>Start Time</label><input type="time" required>
<label>End Time</label><input type="time" required>
<label>Driver Name</label><input required>
<label>Car No</label><input required>
<label>Technician</label><input required>
<label>Detail</label><textarea></textarea>
<button type="submit">Submit</button>
</form>

<hr>
<input id="searchInput" placeholder="Search..." onkeyup="filterTable()">
<button onclick="exportExcel()">Export to Excel</button>

<table id="dataTable">
<thead>
<tr>
<th>Branch</th><th>Date</th><th>Start</th><th>End</th>
<th>Driver</th><th>Car No</th><th>Technician</th><th>Detail</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
// ðŸ”´ PASTE YOUR GOOGLE SCRIPT URL HERE
const scriptURL = "https://script.google.com/macros/s/AKfycbzqUrDGPKhdZW1D_WHWUSQVKeCg88jmff7qi7OIK3pp5q2-vTlJ-K9zLEztmy6lOTQwUQ/exec";

const form=document.getElementById("reportForm");
const body=document.querySelector("#dataTable tbody");

form.addEventListener("submit",e=>{
e.preventDefault();
const d={
branch:form[0].value,
date:form[1].value,
startTime:form[2].value,
endTime:form[3].value,
driver:form[4].value,
carNo:form[5].value,
technician:form[6].value,
detail:form[7].value
};

fetch(scriptURL,{method:"POST",body:JSON.stringify(d)})
.then(()=>{
let r=document.createElement("tr");
Object.values(d).forEach(v=>{
let td=document.createElement("td");
td.textContent=v;r.appendChild(td);
});
body.appendChild(r);
form.reset();
alert("Submitted Successfully");
}).catch(()=>alert("Error"));
});

function filterTable(){
let f=searchInput.value.toLowerCase();
[...body.rows].forEach(r=>{
r.style.display=r.textContent.toLowerCase().includes(f)?"":"none";
});
}

function exportExcel(){
let t=dataTable.outerHTML;
let a=document.createElement("a");
a.href="data:application/vnd.ms-excel,"+t;
a.download="AYA_DV4_Report.xls";
a.click();
}
</script>
</body>
</html>
